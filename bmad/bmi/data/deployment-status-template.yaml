# Deployment Status Tracking Template
# Generated by BMI module
# Copy this to {project-root}/docs/deployments/deployment-status.yaml

# STATUS DEFINITIONS:
# ==================
# Deployment Status:
#   - pending: Deployment queued but not started
#   - in-progress: Deployment actively running
#   - success: Deployment completed successfully
#   - failed: Deployment failed
#   - rolled-back: Deployment was rolled back
#
# Environment Status:
#   - active: Environment is live and serving traffic
#   - inactive: Environment exists but not serving traffic
#   - maintenance: Environment in maintenance mode
#   - archived: Environment decommissioned

# PROJECT METADATA
project_name: ""
last_updated: ""  # Auto-updated on each deployment

# ENVIRONMENTS
environments:
  dev:
    status: active
    platform: ""  # vercel, railway, render, aws, etc.
    url: ""
    last_deployment:
      story_id: ""
      version: ""
      timestamp: ""
      status: ""
      deployed_by: ""

  staging:
    status: active
    platform: ""
    url: ""
    last_deployment:
      story_id: ""
      version: ""
      timestamp: ""
      status: ""
      deployed_by: ""

  production:
    status: active
    platform: ""
    url: ""
    last_deployment:
      epic_id: ""
      version: ""
      timestamp: ""
      status: ""
      deployed_by: ""
      requires_approval: true

# DEPLOYMENT HISTORY
# Each deployment creates an entry
deployment_history:
  # Example entry:
  # - id: "deploy-2025-11-15-001"
  #   story_id: "1-2-workflow-yaml-parser"
  #   epic_id: "epic-1"
  #   environment: "dev"
  #   platform: "vercel"
  #   version: "1.0.0-dev.123"
  #   git_sha: "abc123"
  #   deployed_by: "Diana"
  #   trigger: "orchestrate-story"  # orchestrate-story | orchestrate-epic | manual | hotfix
  #   timestamp_start: "2025-11-15T10:30:00Z"
  #   timestamp_end: "2025-11-15T10:32:45Z"
  #   duration_seconds: 165
  #   status: "success"  # success | failed | rolled-back
  #   deployment_url: "https://dev.example.com"
  #   deployment_logs: "logs/deployments/deploy-2025-11-15-001.log"
  #   smoke_tests:
  #     status: "passed"
  #     tests_run: 15
  #     tests_passed: 15
  #   performance_validation:
  #     status: "passed"
  #     response_time_p95_ms: 245
  #     within_sla: true
  #   database_migrations:
  #     executed: true
  #     migrations_run: 2
  #     status: "success"
  #   rollback_info:
  #     can_rollback: true
  #     previous_version: "1.0.0-dev.122"
  #   notes: ""

# RELEASE HISTORY
# Tracks production releases (epic-level)
release_history:
  # Example entry:
  # - version: "1.0.0"
  #   epic_id: "epic-1"
  #   release_date: "2025-11-15T14:00:00Z"
  #   release_type: "minor"  # major | minor | patch
  #   released_by: "Rita"
  #   changelog_file: "docs/releases/CHANGELOG-1.0.0.md"
  #   release_notes_file: "docs/releases/RELEASE-1.0.0.md"
  #   github_release_url: "https://github.com/org/repo/releases/tag/v1.0.0"
  #   deployment_id: "deploy-2025-11-15-050"
  #   stories_included:
  #     - "1-1-project-repository-structure"
  #     - "1-2-workflow-yaml-parser"
  #     - "1-3-llm-factory-pattern"
  #   dora_metrics:
  #     deployment_frequency: "daily"
  #     lead_time_hours: 24.5
  #     change_failure_rate: 0.02
  #   load_tests:
  #     status: "passed"
  #     max_rps: 1500
  #     p95_latency_ms: 280

# ROLLBACK HISTORY
rollback_history:
  # Example entry:
  # - id: "rollback-2025-11-15-001"
  #   deployment_id: "deploy-2025-11-15-030"
  #   environment: "production"
  #   reason: "Critical bug detected"
  #   timestamp: "2025-11-15T16:00:00Z"
  #   rolled_back_from: "1.2.1"
  #   rolled_back_to: "1.2.0"
  #   executed_by: "Diana"
  #   duration_seconds: 90
  #   status: "success"
  #   incident_id: "incident-2025-11-15-001"

# INCIDENT HISTORY
# Tracks production incidents and responses
incident_history:
  # Example entry:
  # - id: "incident-2025-11-15-001"
  #   severity: "critical"  # critical | high | medium | low
  #   detected_at: "2025-11-15T15:45:00Z"
  #   resolved_at: "2025-11-15T16:05:00Z"
  #   mttr_minutes: 20
  #   environment: "production"
  #   description: "API error rate spike"
  #   root_cause: "Database connection pool exhausted"
  #   resolution: "Increased connection pool size, deployed hotfix"
  #   deployment_id: "deploy-2025-11-15-030"  # Deployment that caused issue
  #   hotfix_deployment_id: "deploy-2025-11-15-031"
  #   rollback_id: "rollback-2025-11-15-001"
  #   post_mortem: "docs/incidents/post-mortem-2025-11-15-001.md"

# DORA METRICS AGGREGATE
# Calculated from deployment history
dora_metrics:
  current_week:
    deployment_frequency: 0
    lead_time_hours_avg: 0
    change_failure_rate: 0
    mttr_minutes_avg: 0

  current_month:
    deployment_frequency: 0
    lead_time_hours_avg: 0
    change_failure_rate: 0
    mttr_minutes_avg: 0

  all_time:
    total_deployments: 0
    successful_deployments: 0
    failed_deployments: 0
    rollbacks: 0
    incidents: 0
